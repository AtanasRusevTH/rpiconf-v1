# local user settings
#
#MACHINE ?= "qemuarm64"
MACHINE ?= "raspberrypi4-64"
MACHINE ?= "qemux86"
MACHINE ?= "qemuarm"
MACHINE ?= "qemumips"
MACHINE ?= "qemumips64"
MACHINE ?= "qemuppc"
MACHINE ?= "beaglebone-yocto"
MACHINE ?= "genericx86"
MACHINE ?= "genericx86-64"
MACHINE ?= "edgerouter"
MACHINE ??= "qemuarm"
MACHINE ??= "qemux86-64"

# TUNE_FEATURES:remove = "cortexa57"
# TUNE_FEATURES:append = " cortexa72"
# DEFAULTTUNE = "cortexa72"

DL_DIR ?= "${TOPDIR}/downloads"
SSTATE_DIR ?= "${TOPDIR}/sstate-cache"
TMPDIR = "${TOPDIR}/tmp"

DISTRO ?= "poky"
DISTRO ?= "poky-tiny"
DISTRO ?= "rpi-base"
DISTRO ?= "poky-bleeding"

# PACKAGE_CLASSES ?= "package_rpm package_deb package_ipk"
PACKAGE_CLASSES ?= "package_rpm package_deb"

EXTRA_IMAGE_FEATURES ?= "debug-tweaks"
USER_CLASSES ?= "buildstats"
PATCHRESOLVE = "noop"

BB_DISKMON_DIRS ??= "\
    STOPTASKS,${TMPDIR},1G,100K \
    STOPTASKS,${DL_DIR},1G,100K \
    STOPTASKS,${SSTATE_DIR},1G,100K \
    STOPTASKS,/tmp,100M,100K \
    HALT,${TMPDIR},100M,1K \
    HALT,${DL_DIR},100M,1K \
    HALT,${SSTATE_DIR},100M,1K \
    HALT,/tmp,10M,1K"

BB_HASHSERVE_UPSTREAM = "hashserv.yocto.io:8687"
SSTATE_MIRRORS ?= "file://.* http://sstate.yoctoproject.org/all/PATH;downloadfilename=PATH"
BB_HASHSERVE = "auto"
BB_SIGNATURE_HANDLER = "OEEquivHash"


# Qemu configuration
#PACKAGECONFIG:append:pn-qemu-system-native = " sdl"
#ASSUME_PROVIDED += "libsdl2-native"
#PACKAGECONFIG:append:pn-qemu-system-native = " gtk+"

CONF_VERSION = "2"

SANITY_TESTED_DISTROS:append = " manjaro"

# FEATURES
##########################################################################
# MACHINE_FEATURES:append = " vc4graphics"
# next line includes iw, wpa 
# MACHINE_FEATURES:append = " wifi"
# MACHINE_FEATURES:append = " touchscreen"

IMAGE_FEATURES:remove = "splash"
IMAGE_FEATURES:remove = "package-management"
EXTRA_IMAGE_FEATURES:append = " ssh-server-dropbear"
# EXTRA_IMAGE_FEATURES:append = " hwcodecs"
# EXTRA_IMAGE_FEATURES:append = " x11"

#DISTRO_FEATURES:append = " directfb"
#DISTRO_FEATURES:append = " keyboard"
#DISTRO_FEATURES:append = " opengl"
#DISTRO_FEATURES:append = " x11"
#DISTRO_FEATURES:append = " wifi"

# INSTALL
##########################################################################
#CORE_IMAGE_EXTRA_INSTALL:append = " packagegroup-core-x11"
#CORE_IMAGE_EXTRA_INSTALL:append = " packagegroup-base-wifi"
CORE_IMAGE_EXTRA_INSTALL:append = " xf86-video-modesetting"
#CORE_IMAGE_EXTRA_INSTALL:append = " xserver-xorg-extension-glx"
#CORE_IMAGE_EXTRA_INSTALL:append = " fontconfig"
#CORE_IMAGE_EXTRA_INSTALL:append = " fontconfig-utils"
#CORE_IMAGE_EXTRA_INSTALL:append = " kernel-modules"

# PACKAGE_INSTALL:prepend = "linux-libc-headers "
PACKAGE_INSTALL:append = " os-release"
# PACKAGE_INSTALL:append = " dhcpcd"
PACKAGE_INSTALL:append = " thcp"
# PACKAGE_INSTALL:append = " mesa"
#PACKAGE_INSTALL:append = " glfw"
PACKAGE_INSTALL:append = " imgui"
PACKAGE_INSTALL:append = " xf86-video-fbdev"
# PACKAGE_INSTALL:append = " xf86-video-vmware"
# PACKAGE_INSTALL:remove = " mesa"
# PACKAGE_INSTALL:append = " iw"
# PACKAGE_INSTALL:append = " wpa-supplicant"
#PACKAGE_INSTALL:append = " xserver-xf86-config"
#PACKAGE_INSTALL:append = " hwlatdetect"
#PACKAGE_INSTALL:append = " virglrenderer"
#PACKAGE_INSTALL:append = " directfb"
PACKAGE_INSTALL:append = " xorg-minimal-fonts"
#PACKAGE_INSTALL:append = " xorg-fonts-100dpi"
PACKAGE_INSTALL:append = " xkbcomp"
# PACKAGE_INSTALL:append = " mesa-demos"
# PACKAGE_INSTALL:append = " opengl-es-cts"

#PACKAGECONFIG:append:pn-mesa = " gbm"


IMAGE_FSTYPES:remove = " tar.bz2"
IMAGE_FSTYPES:remove = " wic.bz2"
IMAGE_FSTYPES:remove = " wic.bmap"
IMAGE_FSTYPES:append = "${@' wic' if d.getVar('MACHINE') == 'raspberrypi4-64' else ''}"
# IMAGE_FSTYPES:append = "${@' rpi-sdimg' if d.getVar('MACHINE') == 'raspberrypi4-64' else ''}"
# IMAGE_FSTYPES = "tar.bz2 ext3 rpi-sdimg"

# PREFERRED_PROVIDER_virtual/kernel ??= "linux-raspberrypi"
# PREFERRED_PROVIDER_virtual/kernel ??= "linux-yocto-rt"
# PREFERRED_PROVIDER_virtual/kernel ??= "linux-yocto-tiny"
# PREFERRED_PROVIDER_virtual/libgl ??= "mesa"
# PREFERRED_PROVIDER_virtual/libgl ?= "mesa-gl"
# PREFERRED_PROVIDER_virtual/mesa ?= "mesa-gl"
# PREFERRED_PROVIDER_virtual/libgbm ?= "mesa-gl"
# PREFERRED_PROVIDER_virtual/crypt = "libxcrypt"
# PACKAGE_DEBUG_SPLIT_STYLE = "debug-without-src"
# WKS_FILE_DEPENDS="virtual/bootloader"

# DISABLE_VC4GRAPHICS = "1"
# ENABLE_I2C = "1"

# RPI_USE_U_BOOT = "1"
# ENABLE_UART = "1"

DISABLE_SPLASH = "1"
DISABLE_RPI_BOOT_LOGO = "1"
# DISABLE_VC4GRAPHICS = "1"
# GPU_MEM = "32"

BOOT_DELAY = "0"
BOOT_DELAY_MS = "0"


# INHERIT:append = " rm_work"